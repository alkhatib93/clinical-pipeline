// Nextflow configuration file for clinical pipeline

params {
  vep_cache = "${System.getenv('HOME')}/vep_data"
  vep_fasta = "${System.getenv('HOME')}/vep_data/Homo_sapiens.GRCh38.dna.toplevel.fa.gz"
  gnomad_vcf = "${System.getenv('HOME')}/vep_data/somatic-hg38_af-only-gnomad.hg38.vcf.gz"
  revel_vcf = "${System.getenv('HOME')}/vep_data/new_tabbed_revel_grch38.tsv.gz"
  clinvar_vcf = "${System.getenv('HOME')}/vep_data/clinvar.vcf.gz"
  vep_plugins = "${System.getenv('HOME')}/vep_plugins"
}


// Process configuration
process {
    // Default resource requirements
    cpus = 1
    memory = '2 GB'
    time = '1h'
    
    // Error strategy
    errorStrategy = 'terminate'
    maxRetries = 2
    
    // Publish directory mode
    publishDir = [
        path: { "results/${task.process.tokenize(':')[-1].toLowerCase()}" },
        mode: 'copy',
        enabled: true
    ]
    
}

// Executor configuration
executor {
    name = 'local'
    queueSize = 100
}

// Manifest
manifest {
    name = 'clinical-pipeline'
    author = 'Clinical Team'
    description = 'Simplified clinical variant calling pipeline'
    version = '1.0.0'
}

// Report configuration
report {
    enabled = true
    file = "results/pipeline_report.html"
    overwrite = true
}

// Timeline configuration
timeline {
    enabled = true
    file = "results/timeline_report.html"
    overwrite = true
}

// Trace configuration
trace {
    enabled = true
    file = "results/trace.txt"
    overwrite = true
}

docker {
  enabled = true
}

process {
  withName:VEP_Annotate {
    container = 'ensemblorg/ensembl-vep'
    containerOptions = "-u ${System.getenv('MY_UID')}:${System.getenv('MY_GID')} -v ${params.vep_cache}:/cache:ro"
  }
}

// Singularity configuration (optional)
singularity {
    enabled = false
    // image = 'your-singularity-image.sif'
} 